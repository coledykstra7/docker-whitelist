<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Squid Proxy List Editor</title>
<link rel="stylesheet" href="/static/template.css">
<script src="/static/template.js"></script>
</head>
<body>
<div class="ctrl-panel">
    <div><strong>Controls</strong></div>
    <div style="margin-top:4px">Squid: <span id="squidStatus">...</span> <button id="reloadBtn" type="button" onclick="reloadSquid()">Reload</button></div>
    <div style="margin-top:4px"><label><input type="checkbox" id="autoRefresh" checked/> Auto-Refresh (5s)</label></div>
    <div style="margin-top:4px">
        <button type="button" onclick="clearAllLogs()">Clear Logs</button>
    </div>
</div>
<h1>Squid Proxy List Editor</h1>
<div style="margin-bottom:16px;max-width:900px;">
    <label for="domainNote" style="display:block;margin-bottom:4px;font-weight:600;">Note for new entries:</label>
    <input type="text" id="domainNote" placeholder="e.g., alaska project, marketing team, etc." style="width:100%;padding:8px;border:1px solid #ccc;border-radius:4px;font-size:14px;">
    <small style="color:#666;">This note will be added to domains when using action buttons (→ WL, → BL) • <span style="color:#28a745;">Auto-saved</span></small>
</div>
<form method="POST" action="/save">
    <div class="grid">
        <div>
            <h2>Whitelist</h2>
            <div id="whitelist-table-container">
                <table class="list-table" id="whitelist-table">
                    <tr><th>Actions</th><th>Domain</th><th>Note</th></tr>
                </table>
                <div style="margin-top:8px;">
                    <input type="text" id="new-wl-domain" placeholder="Add domain..." style="padding:4px;margin-right:4px;width:200px;">
                    <input type="text" id="new-wl-note" placeholder="Note (optional)..." style="padding:4px;margin-right:4px;width:150px;">
                    <button type="button" onclick="addToList('whitelist')" style="padding:4px 8px;">Add</button>
                </div>
            </div>
            <textarea name="whitelist" id="whitelist-hidden" style="display:none;">{{.Whitelist}}</textarea>
        </div>
        <div>
            <h2>Blacklist</h2>
            <div id="blacklist-table-container">
                <table class="list-table" id="blacklist-table">
                    <tr><th>Actions</th><th>Domain</th><th>Note</th></tr>
                </table>
                <div style="margin-top:8px;">
                    <input type="text" id="new-bl-domain" placeholder="Add domain..." style="padding:4px;margin-right:4px;width:200px;">
                    <input type="text" id="new-bl-note" placeholder="Note (optional)..." style="padding:4px;margin-right:4px;width:150px;">
                    <button type="button" onclick="addToList('blacklist')" style="padding:4px 8px;">Add</button>
                </div>
            </div>
            <textarea name="blacklist" id="blacklist-hidden" style="display:none;">{{.Blacklist}}</textarea>
        </div>
    </div>
    <p><button type="submit" onclick="return updateHiddenTextareas()">Save</button></p>
</form>
<h2>Access Log Summary (Live)</h2>
<div class="summary-box" id="summary-box">
    <div style="margin-bottom:8px">
        <label><input type="checkbox" id="filterWL" checked> WL (✅)</label>
        <label><input type="checkbox" id="filterBL" checked> BL (❌)</label>
        <label><input type="checkbox" id="filterRG" checked> RG (❓)</label>
    </div>
    <div id="summary-content"></div>
    <p><span class="status whitelist">✅ Whitelisted</span> <span class="status blacklist">❌ Blacklisted</span> <span class="status unknown">❓ Unknown</span></p>
</div>
<h2>Access Log (Live Tail 50 lines)</h2>
<pre id="log">(waiting for log...)</pre>
</body>
</html>
